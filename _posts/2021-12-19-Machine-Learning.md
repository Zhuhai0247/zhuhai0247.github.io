---
title: "Machine Learning"
subtitle: "æœ‰ä¸€ç§ä»€ä¹ˆéƒ½å­¦äº†ä½†ä»€ä¹ˆéƒ½æ²¡å­¦çš„æ„Ÿè§‰"
layout: post
author: "Zhuhai"
header-style: text
tags:
  - Lab0 Machine Learning å­¦ä¹ æ€»ç»“
---


## chap2 æœºå™¨å­¦ä¹ åŸºæœ¬æ¦‚å¿µ

### åè¯
`æ•°æ®é›† Data Set` : ä¸€ç»„æ ‡è®°å¥½ `ç‰¹å¾ Feature` å’Œ `æ ‡ç­¾ Label` çš„ `æ ·æœ¬ Sample` ï¼ŒåŒ…å« `è®­ç»ƒé›† Training Set/Sample` å’Œ `æµ‹è¯•é›† Test Set/Sample` ã€‚

å…¶ä¸­ï¼Œç‰¹å¾ç”± D ç»´`ç‰¹å¾å‘é‡` $x=[x_1,x_2,...,x_D]^T$ è¡¨ç¤ºï¼Œæ ‡ç­¾ç”±æ ‡é‡ $y$ è¡¨ç¤ºã€‚

åˆ™ç‹¬ç«‹åŒåˆ†å¸ƒçš„ N ä¸ªæ ·æœ¬ç»„æˆçš„è®­ç»ƒé›† D å¯ä»¥è®°ä¸º $D = [(x^{(1)},y^{(1)},(x^{(2)},y^{(2)}),...,(x^{(N)},y^{(N)}))]$

é¢„æµ‹å‡½æ•°ï¼š $f^*(x)$ ï¼Œä»ä¸€ä¸ªå‡½æ•°é›†åˆä¸­è‡ªåŠ¨å¯»æ‰¾æœ€ä¼˜å‡½æ•°è¿‘ä¼¼æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡å’Œæ ‡ç­¾ä¹‹é—´çš„çœŸå®æ˜ å°„å…³ç³»ã€‚

è¯„ä»·æ–¹æ³•ï¼š $Acc(f^*(x))$

![](https://raw.githubusercontent.com/Zhuhai0247/blog-img/master/202210102125946.png)

### æœºå™¨å­¦ä¹ ä¸‰è¦ç´ ï¼šæ¨¡å‹ï¼Œå­¦ä¹ å‡†åˆ™ï¼Œä¼˜åŒ–ç®—æ³•

#### æ¨¡å‹ï¼šçº¿æ€§ä¸éçº¿æ€§æ¨¡å‹

- æ¦‚å¿µï¼šç”±è¾“å…¥äº§ç”Ÿæ­£ç¡®è¾“å‡ºçš„å‡½æ•° / æ¦‚ç‡æ¨¡å‹ã€‚æ±‚å‡ºè¯¥æ¨¡å‹æ˜¯æœ€ç»ˆç›®æ ‡ã€‚
- ä½œç”¨ï¼šç¡®å®š `å‡è®¾ç©ºé—´`ï¼ˆè¾“å…¥ç©ºé—´åˆ°è¾“å‡ºç©ºé—´çš„æ˜ å°„çš„é›†åˆï¼‰

#### å­¦ä¹ å‡†åˆ™ï¼ˆç­–ç•¥ï¼‰ï¼šé€‰æ‹©æ¨¡å‹
- æ¦‚å¿µï¼šä»é›†åˆä¸­é€‰æ‹©å…·ä½“çš„æ¨¡å‹ï¼Œå³ç­–ç•¥ã€‚ç­–ç•¥æ–¹æ³•åˆ†ä¸ºæœ‰æŸå¤±å‡½æ•°ä¸é£é™©å‡½æ•°ä¸¤ç§ã€‚
  - æŸå¤±å‡½æ•°ï¼šå®šä¹‰åœ¨å•ä¸ªæ ·æœ¬ï¼Œåº¦é‡é¢„æµ‹é”™è¯¯çš„ç¨‹åº¦ã€‚
    - `0-1æŸå¤±å‡½æ•°`ï¼š $â„’(ğ‘¦,f(x;\theta))=I(y\neq f(x;\theta))$
    - `å¹³æ–¹æŸå¤±å‡½æ•°`ï¼š$â„’(ğ‘¦,f(x;\theta))=\frac{1}{2}(y-f(x;\theta))$
    - `äº¤å‰ç†µæŸå¤±å‡½æ•°`ï¼šåº¦é‡æ¦‚ç‡åˆ†å¸ƒé—´çš„å·®å¼‚æ€§ã€‚$â„’(ğ‘¦,f(x;\theta))=-\sum^C_{c=1}y_clnf_c(x;\theta)$
      - ä¿¡æ¯ç†µï¼š$H(X)=-\sum^n_{i=1}P(x_i)ln(P(x_i))$
      - ç›¸å¯¹ç†µï¼ˆKLæ•£åº¦ï¼‰ï¼š$D_{KL}(p||q)=\sum^n_{i=1}p(x_i)ln(\frac{p(x_i)}{q(x_i)})$ï¼Œå…¶ä¸­P(x)ä¸ºæ ·æœ¬çœŸå®åˆ†å¸ƒï¼ŒQ(x)ä¸ºæ¨¡å‹æ‰€é¢„æµ‹çš„åˆ†å¸ƒã€‚
      - äº¤å‰ç†µï¼šç›¸å¯¹ç†µ + ä¿¡æ¯ç†µï¼Œæ ¹æ®å¯¹æ•°åŠ å‡åŸç†(æä¸€ä¸ªè´Ÿå·å‡ºæ¥)ï¼Œäº¤å‰ç†µ $H(p,q)=-\sum^n_{i=1}p(x_i)ln(q(x_i))$
    - `HingeæŸå¤±å‡½æ•°`ï¼š$â„’(ğ‘¦,f(x;\theta))=max(0,1-yf(x;\theta))$
  - é£é™©ï¼ˆä»£ä»·ï¼‰å‡½æ•°ï¼šå®šä¹‰åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šã€‚
    - ç»éªŒé£é™©ï¼šæ¯ä¸ªæ ·æœ¬çš„å¹³å‡æŸå¤±ã€‚$R^{emp}_D(\theta)=\frac{1}{N}\sum^N_{n=1}â„’(y^{(n)},f(x^{(n)};\theta))$
    - ç»“æ„é£é™©ï¼šé˜²æ­¢æ¨¡å‹è¿‡æ‹ŸåˆåŠ å…¥æ­£åˆ™åŒ–é¡¹ã€‚

#### ä¼˜åŒ–ç®—æ³•ï¼šæ±‚è§£æ¨¡å‹å‚æ•°

- æ¦‚å¿µï¼šæœºå™¨å­¦ä¹ çš„è®­ç»ƒè¿‡ç¨‹å…¶å®å°±æ˜¯æœ€ä¼˜åŒ–é—®é¢˜çš„æ±‚è§£è¿‡ç¨‹ã€‚
  - è¶…å‚æ•°ï¼šå®šä¹‰æ¨¡å‹ç»“æ„æˆ–ä¼˜åŒ–ç­–ç•¥ï¼Œæ— éœ€å­¦ä¹ ï¼Œå‡­é ç»éªŒã€‚
  - å‚æ•°ï¼šå³ğ‘“(ğ’™; ğœƒ)ä¸­çš„ ğœƒï¼Œé€šè¿‡ä¼˜åŒ–ç®—æ³•è¿›è¡Œå­¦ä¹ ã€‚ 
- æ¢¯åº¦ä¸‹é™æ³•ï¼šé€šè¿‡è¿­ä»£æ‰¾åˆ°ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ï¼Œæˆ–è€…æ”¶æ•›åˆ°æœ€å°å€¼ã€‚
  - æ¢¯åº¦ï¼šå¤šå˜é‡å¾®åˆ†çš„ä¸€èˆ¬åŒ–ï¼Œåˆ†åˆ«å¯¹æ¯ä¸ªå˜é‡å¾®åˆ†åç»„æˆçš„å‘é‡é›†åˆã€‚æ¢¯åº¦çš„æ–¹å‘ä¸ºå‡½æ•°åœ¨ç»™å®šç‚¹ä¸Šå‡æœ€å¿«çš„æ–¹å‘ã€‚æ•…æ²¿æ¢¯åº¦åå‘å³ä¸‹é™æœ€å¿«ã€‚
  - æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•(BGD)ï¼šç›®æ ‡å‡½æ•°ä¸ºæ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„é£é™©å‡½æ•°ï¼š$\theta _{t+1}=\theta _t - \alpha \frac{\partial{R_D(\theta)}}{\partial{\theta}}$ï¼Œå…¶ä¸­ $\alpha$ ä¸º`å­¦ä¹ ç‡`ã€‚
  - æå‰åœæ­¢ï¼šæ¯æ¬¡è¿­ä»£åï¼Œæ–°æ¨¡å‹åœ¨æµ‹è¯•é›†æµ‹è¯•ï¼Œè‹¥é”™è¯¯ç‡ä¸å†ä¸‹é™ï¼Œåˆ™åœæ­¢ã€‚
  - éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼ˆSGDï¼‰ï¼šä¸ºå‡å°‘è¿­ä»£çš„è®¡ç®—å¤æ‚åº¦ï¼Œæ¯æ¬¡è¿­ä»£æ—¶åªï¼ˆéšæœºï¼‰é‡‡é›†ä¸€ä¸ªæ ·æœ¬ï¼Œè®¡ç®—è¿™ä¸ªæ ·æœ¬æŸå¤±å‡½æ•°çš„æ¢¯åº¦å¹¶æ›´æ–°å‚æ•°ã€‚
  - å°æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•ï¼šå……åˆ†åˆ©ç”¨è®¡ç®—æœºçš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œæ¯æ¬¡éšæœºæŠ½å–Kä¸ªæ ·æœ¬è®¡ç®—é£é™©å‡½æ•°å†è¿›è¡Œè¿­ä»£ã€‚


## chap3 çº¿æ€§æ¨¡å‹

æ¦‚å¿µï¼šé€šè¿‡æ ·æœ¬ç‰¹å¾çš„çº¿æ€§ç»„åˆæ¥è¿›è¡Œé¢„æµ‹çš„æ¨¡å‹ã€‚
æ¨¡å‹å½¢å¼ï¼ˆåˆ¤åˆ«å‡½æ•°ï¼‰ï¼š$f(x;w)=w^Tx+b$ï¼Œw ä¸ºæƒé‡å‘é‡ï¼Œ b ä¸ºåç½®ã€‚
å†³ç­–å‡½æ•°ï¼šå°†æ¨¡å‹å€¼åŸŸæ”¾ç¼©åˆ°å¯é¢„æµ‹çš„èŒƒå›´
$g(Â·)  ---> y=g(f(x;w))$


#### çº¿æ€§åˆ¤åˆ«å‡½æ•°å’Œå†³ç­–è¾¹ç•Œ

åˆ†ç±»ï¼šäºŒåˆ†ç±»ï¼ˆåªéœ€è¦ä¸€ä¸ªçº¿æ€§åˆ¤åˆ«å‡½æ•°ï¼Œæ»¡è¶³å‡½æ•°ä¸º0çš„ç‚¹ç»„æˆä¸€ä¸ªåˆ†å‰²è¶…å¹³é¢ï¼Œå³å†³ç­–å¹³é¢ï¼‰ï¼›å¤šåˆ†ç±»ï¼ˆä¸€å¯¹å…¶ä½™ï¼›ä¸€å¯¹ä¸€ï¼›argmaxï¼‰

#### Logisticå›å½’ï¼šäºŒåˆ†ç±»

æ¿€æ´»å‡½æ•°ï¼šLogisticå‡½æ•° $y=g(Â·)=\frac{1}{1+exp(-w^Tx)}$ï¼Œè¿™é‡Œçš„w,xå·²å¢å¹¿ã€‚

æ ‡ç­¾ï¼š$y=\{0,1\}$ï¼Œåˆ™$q(y=1 | x) = \frac{1}{1+exp(-w^Tx)}ï¼Œq(y=0 | x)=1-q(y=1|x)$ã€‚

æŸå¤±å‡½æ•°ï¼šé‡‡ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ã€‚

é£é™©å‡½æ•°ï¼š$R(w)=-\frac{1}{N}\sum^N_{n=1}(p(y^{(n)}=1|x^{(n)})ln(g(w^Tx^{(n)}))+p(y^{(n)}=0|x^{(n)})ln(1-g(w^Tx^{(n)})))$ã€‚

æ¢¯åº¦ä¸‹é™ï¼š$w_{t+1}<--w_t+\alpha \frac{1}{N}\sum^N_{n=1}x^{(n)}(p(y=1|x^{(n)})-g(w^Tx^{(n)})_{w_t})$ï¼Œå…¶ä¸­pä¸ºå…¶çœŸå®æ¦‚ç‡ï¼Œg(wx)ä¸ºé¢„æµ‹æ¦‚ç‡ã€‚

#### softmaxå›å½’ï¼šå¤šåˆ†ç±»

æ¿€æ´»å‡½æ•°ï¼šSoftmaxå‡½æ•°$z_k=softmax(x_k)=\frac{exp(x_k)}{\sum_{i=1}^Kexp(x_i)}$

æ ‡ç­¾ï¼š$y=\{1,2,...,C\}$ï¼Œåˆ™$q(y=c|x)=softmax(w^T_cx)$

å†³ç­–å‡½æ•°ï¼š$y=argmax^C_{c=1}q(y=c|x)$

æŸå¤±å‡½æ•°ï¼šé‡‡ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ã€‚

é£é™©å‡½æ•°ï¼š$R(w)=-\frac{1}{N}\sum^N_{n=1}(p(y=c|x)ln(argmax^C_{c=1}q(y=c|x)))$ï¼Œå…¶ä¸­pä¸ºçœŸå®æ¦‚ç‡ï¼Œqä¸ºé¢„æµ‹æ¦‚ç‡ã€‚

æ¢¯åº¦ä¸‹é™ï¼š$w_{t+1}<--w_t+\alpha \frac{1}{N}\sum^N_{n=1}x^{(n)}(p(y=c|x^{(n)})-q(y=c|x^{(n)})_{w_t})$

#### æ”¯æŒå‘é‡æœºSVMï¼šäºŒåˆ†ç±»



## å‰é¦ˆç¥ç»ç½‘ç»œ

#### Sigmoidå‹å‡½æ•°

ä¸€ç±» S å‹æ›²çº¿å‡½æ•°ï¼Œä¸¤ç«¯é¥±å’Œï¼š
- Logisticå‡½æ•°ï¼š$\sigma (x) = \frac{1}{1+exp(-x)}$ï¼Œå°†å®æ•°åŸŸæŒ¤å‹åˆ°[0,1]
  - è¿‘ä¼¼å‡½æ•°ï¼šmax(min(0.25x+0.5,1),0)
- Tanhå‡½æ•°ï¼š$tanh(x)=\frac{exp(x)-exp(-x)}{exp(x)+exp(-x)}$ï¼Œå°†å®æ•°åŸŸæŒ¤å‹åˆ°[-1,1]
  - è¿‘ä¼¼å‡½æ•°ï¼šmax(min(x,1),-1)

#### ReLUå‡½æ•°

- ReLU æ˜¯ä¸€ä¸ªæ–œå¡å‡½æ•°ï¼š$ReLU(x)=max(0,x)$
- å¸¦æ³„éœ²çš„ ReLU å‡½æ•°é¿å…æ­»äº¡ReLUå‡½æ•°ï¼Œåœ¨è¾“å…¥å°äº0æ—¶ä¿ç•™ä¸€ä¸ªæ¢¯åº¦é˜²æ­¢ç¥ç»å…ƒä¸èƒ½è¢«æ¿€æ´»ï¼š$LeakyReLU(x)=max(0,x)+y*min(0,x)=max(x,yx)$ï¼Œä¸€èˆ¬yå¾ˆå°ï¼Œå¦‚0.01ã€‚
-  å¸¦å‚æ•°çš„ ReLU å¼•å…¥ä¸€ä¸ªå¯å­¦ä¹ çš„å‚æ•°ï¼Œå¯¹äºç¬¬ i ä¸ªç¥ç»å…ƒï¼š$PReLU_i(x)=max(0,x)+y_imin(0,x)$
-  ELU æ˜¯ä¸€ä¸ªè¿‘ä¼¼çš„é›¶ä¸­å¿ƒåŒ–çš„éçº¿æ€§å‡½æ•°ï¼š$ELU(x)=max(0,x)+min(0,y(exp(x)-1))$ï¼Œå…¶ä¸­ y æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚
-  Softplus æ˜¯ ReLU å‡½æ•°çš„å¹³æ»‘ç‰ˆæœ¬ï¼š$Softplus(x)=ln(1+exp(x))$

#### å‰é¦ˆç½‘ç»œ

å¯çœ‹ä¸ºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ï¼ŒåŒ…æ‹¬å…¨è¿æ¥å‰é¦ˆç½‘ç»œå’Œå·ç§¯ç¥ç»ç½‘ç»œã€‚

#### å…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œ

- ç¬¬0å±‚ç§°ä¸º`è¾“å…¥å±‚`ï¼Œæœ€åä¸€å±‚ç§°ä¸º`è¾“å‡ºå±‚`ï¼Œå…¶ä»–ä¸­é—´å±‚ç§°ä¸º`éšè—å±‚`ã€‚
  - $input_i = Weight_i*output_{i-1}+bias_i$
  - $output_i=activationf_i(input_i)$
  - $x=input_0->output_1->input_1->output_2->...->z_i->a_i->...->output$
- å°†å¤šå±‚å‰é¦ˆç¥ç»ç½‘ç»œçœ‹ä½œç‰¹å¾è½¬æ¢æ–¹æ³•ï¼Œä½¿å…¶æœ€ç»ˆè¾“å‡ºä½œä¸ºåˆ†ç±»å™¨çš„è¾“å…¥è¿›è¡Œåˆ†ç±»ã€‚
  - äºŒåˆ†ç±»é—®é¢˜ï¼šé‡‡ç”¨ Logistic å›å½’ï¼Œå³è¾“å‡ºå±‚ä¸ºä¸€ä¸ªç¥ç»å…ƒï¼Œä¸”æ¿€æ´»å‡½æ•°ä¸º Logistic å‡½æ•°ã€‚
  - å¤šåˆ†ç±»é—®é¢˜ï¼šé‡‡ç”¨ Softmax å›å½’ï¼Œç›¸å½“äºè¾“å‡ºå±‚è®¾ç½® C ä¸ªç¥ç»å…ƒï¼Œå…¶æ¿€æ´»å‡½æ•°ä¸º Softmax å‡½æ•°ã€‚

- å‚æ•°å­¦ä¹ 
  - æŸå¤±å‡½æ•°ï¼ˆé‡‡ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼‰ï¼š$â„’(y,y')=-y^Tlny'$ï¼Œå…¶ä¸­æ ·æœ¬ä¸º(x,y)ï¼Œyä¸ºçœŸå®å€¼ï¼Œy'ä¸ºé¢„æµ‹å€¼ã€‚
  - é£é™©å‡½æ•°ï¼ˆç»“æ„åŒ–é£é™©å‡½æ•°ï¼‰ï¼š$R(W,b)=\frac{1}{N}\sum^N_{n=1}â„’(y^{(n)},y'^{(n)})+\frac{1}{2}\lambda||W||^2_F$
    - è¿™é‡Œ $|W||^2_F$ ä¸º Frobenius èŒƒæ•°ï¼š$|W||^2_F = \sum^L_{l=1}\sum^{M_l}_{i=1}\sum^{M_{l-1}}_{j=1}(w_{ij}^{(l)})^2$
  - æ¢¯åº¦ä¸‹é™æ³•ï¼šéœ€è¦è®¡ç®—W,bä¸¤ä¸ªæ¢¯åº¦ã€‚

- åå‘ä¼ æ’­ç®—æ³•
  > [å‚è€ƒ](https://blog.csdn.net/ft_sunshine/article/details/90221691),åˆ©ç”¨é“¾å¼æ³•åˆ™è®¡ç®—è¯¯å·®é¡¹ã€‚
  - ä¸ºé¿å…è®¡ç®—å¤æ‚æ¢¯åº¦æ‰€è®¾è®¡ã€‚

- è‡ªåŠ¨æ¢¯åº¦è®¡ç®—ï¼š
  - æ•°å€¼å¾®åˆ†ï¼šéš¾ç‚¹åœ¨äºå¦‚ä½•æ‰¾åˆ°æ‰°åŠ¨xã€‚
  - ç¬¦å·å¾®åˆ†ã€‚
  - è‡ªåŠ¨å¾®åˆ†ã€‚

- å‚æ•°å­¦ä¹ 
  - éå‡¸ä¼˜åŒ–é—®é¢˜
  - æ¢¯åº¦æ¶ˆå¤±é—®é¢˜


## chap5 å·ç§¯ç¥ç»ç½‘ç»œ

### ç½‘ç»œç»“æ„å’Œç›¸å…³æ¦‚å¿µ

- ç›®å‰å·ç§¯ç¥ç»ç½‘ç»œä¸€èˆ¬æ˜¯ç”±å·ç§¯å±‚ã€æ±‡èšå±‚å’Œå…¨è¿æ¥å±‚äº¤å‰å †å è€Œæˆçš„å‰é¦ˆç¥ç»ç½‘ç»œã€‚
  - ç‰¹ç‚¹ï¼šå±€éƒ¨è¿æ¥ï¼›æƒé‡å…±äº«ï¼›æ±‡èšã€‚
  - ä¼˜ç‚¹ï¼šä¸å˜æ€§ï¼›å‚æ•°å°‘ã€‚


> [å·ç§¯ã€æ± åŒ–ç›¸å…³æ¦‚å¿µå‚è€ƒ](https://blog.csdn.net/quiet_girl/article/details/84579038)
- å·ç§¯ï¼šè¾“å…¥å’Œå·ç§¯æ ¸çš„å†…ç§¯è¿ç®—ã€‚
  - å·ç§¯çš„ä¸‰ç§æ¨¡å‹
    - Fullæ¨¡å¼ï¼šç¬¬ä¸€ä¸ªçª—å£åªåŒ…å«1ä¸ªè¾“å…¥çš„å…ƒç´ ï¼Œå³ä»å·ç§¯æ ¸ï¼ˆfileterï¼‰å’Œè¾“å…¥åˆšç›¸äº¤å¼€å§‹åšå·ç§¯ã€‚æ²¡æœ‰å…ƒç´ çš„éƒ¨åˆ†åšè¡¥0æ“ä½œã€‚
    - Validæ¨¡å¼ï¼šå·ç§¯æ ¸å’Œè¾“å…¥å®Œå…¨ç›¸äº¤å¼€å§‹åšå·ç§¯ï¼Œè¿™ç§æ¨¡å¼ä¸éœ€è¦è¡¥0ã€‚
    - Sameæ¨¡å¼ï¼šå½“å·ç§¯æ ¸çš„ä¸­å¿ƒCå’Œè¾“å…¥å¼€å§‹ç›¸äº¤æ—¶åšå·ç§¯ã€‚æ²¡æœ‰å…ƒç´ çš„éƒ¨åˆ†åšè¡¥0æ“ä½œã€‚
  - å·ç§¯æ ¸ä¸€èˆ¬ä¸ºå¥‡æ•°ï¼Œæ­¤æ—¶æœ‰ä¸­å¿ƒåƒç´ ç‚¹ï¼Œæ–¹ä¾¿å®šä½å·ç§¯æ ¸ã€‚
  - åå·ç§¯ï¼šå°†è¾“å‡º(feature map)è¿˜åŸï¼Œè¿™é‡Œçš„è¿˜åŸæŒ‡ç»´åº¦ä¸Šçš„ç›¸ç­‰ã€‚
- æ± åŒ–(æ±‡èš)ï¼šèµ·åˆ°é™ç»´çš„ä½œç”¨ã€‚
  - æœ€å¤§æ± åŒ–ï¼šå¯¹å±€éƒ¨çš„å€¼å–æœ€å¤§å€¼ã€‚
  - å¹³å‡æ± åŒ–ï¼šå¯¹å±€éƒ¨çš„å€¼å–å¹³å‡ã€‚
  - éšæœºæ± åŒ–ï¼šæ ¹æ®æ¦‚ç‡å¯¹å±€éƒ¨å€¼é‡‡æ ·ã€‚
  - åæ± åŒ–
    - åæœ€å¤§æ± åŒ–ï¼šå…¶ä»–ä½ç½®æ·»é›¶ï¼Œéœ€è®°å½•æœ€å¤§å€¼åŸä½ç½®ã€‚
    - åå¹³å‡æ± åŒ–ï¼šå…¨å¡«å‡å€¼å³å¯ï¼Œæ— éœ€è®°å½•åŸä½ç½®ã€‚

### å·ç§¯å±‚

ä¸€èˆ¬æ¥è¯´ï¼Œä¸€ä¸ªå·ç§¯å±‚çš„æ“ä½œåŒ…æ‹¬ï¼š
1. ç”¨å·ç§¯æ ¸ $W^{p,1},W^{p,2},...,W^{p,D}$ åˆ†åˆ«å¯¹è¾“å…¥ç‰¹å¾æ˜ å°„ $X^1,X^2,...,X^D$ è¿›è¡Œå·ç§¯ã€‚
2. å°†å·ç§¯ç»“æœç›¸åŠ ï¼Œå¹¶åŠ ä¸Šåç½® $bias^p$ï¼Œå¾—åˆ°å·ç§¯å±‚çš„å‡€è¾“å…¥ $Z^p$ ã€‚
3. ç»è¿‡éçº¿æ€§æ¿€æ´»å‡½æ•°(ReLU)åï¼Œæœ€ç»ˆå¾—åˆ°è¾“å‡ºç‰¹å¾æ˜ å°„ $Y^p$ã€‚

- æ•´ä½“ç»“æ„ï¼šè¾“å…¥ -> ã€[å·ç§¯ -> ReLU] \* (2,5) -> æ±‡èšå±‚ * (0,1)ã€‘\* (1,100) -> å…¨è¿æ¥å±‚ * (0,2)
- å‚æ•°å­¦ä¹ ï¼šæ•´ä½“æ¥è¯´ï¼Œå·ç§¯ç½‘ç»œä¸­å‚æ•°ä¸ºå·ç§¯æ ¸çš„æƒé‡ä»¥åŠåç½®ã€‚ç±»ä¼¼äºå…¨è¿æ¥å‰é¦ˆç½‘ç»œï¼Œå·ç§¯ç½‘ç»œä¹Ÿå¯ä»¥é€šè¿‡è¯¯å·®åå‘ä¼ æ’­ç®—æ³•è¿›è¡Œå‚æ•°å­¦ä¹ ã€‚




### ä»£ç é˜…è¯»åŠå‡½æ•°ç§¯ç´¯

**Conv2D**ï¼šå·ç§¯
```py
from tensorflow.keras.layers import Conv2D

# å‚æ•°

Conv2D( inputs,         # æŠŠä¸Šä¸€å±‚çš„è¾“å‡ºä½œä¸ºè¾“å…¥
        input_shape,    # è¾“å…¥å½¢çŠ¶
        filters,        # å·ç§¯è¿‡æ»¤å™¨çš„æ•°é‡,å¯¹åº”è¾“å‡ºçš„ç»´æ•°
        padding,        # valid;same;full
        activation,     # æ¿€æ´»å‡½æ•°,Noneæ˜¯çº¿æ€§å‡½æ•°
        ...
        )
```

**MaxPooling2D** / **tf.nn.max_pool**ï¼šæ± åŒ–(æœ€å¤§å€¼ç­–ç•¥)

```py
from tensorflow.keras.layers import MaxPooling2D

# å‚æ•°

MaxPooling2D( pool_size=(x,y),  # é…ç½®æ± åŒ–çª—å£çš„ç»´åº¦ï¼ŒåŒ…æ‹¬é•¿å’Œå®½ã€‚
                                # æ•°å€¼æ˜¯åŒ…å«ä¸¤ä¸ªæ•´å‹å…ƒç´ å€¼çš„åˆ—è¡¨æˆ–è€…å…ƒç»„ã€‚
              strides=x,        # æ­¥é•¿
              padding,          # åŒä¸Š
              data_format       # é…ç½®è¾“å…¥å›¾åƒæ•°æ®çš„æ ¼å¼ï¼Œé»˜è®¤æ ¼å¼æ˜¯channels_lastï¼Œ
                                # ä¹Ÿå¯ä»¥æ˜¯æ ¹æ®éœ€è¦è®¾ç½®æˆchannels_firstã€‚
                                # åœ¨è¿›è¡Œå›¾åƒæ•°æ®å¤„ç†æ—¶ï¼Œå›¾åƒæ•°æ®çš„æ ¼å¼åˆ†ä¸º
                                # channels_last(batch, height, width, channels)å’Œ
                                # channels_first(batch, channels, height, width)ã€‚

)

pooling = tf.nn.max_pool(   
                    h,   
                    ksize=[1, height, width, 1],  
                    strides=[1, 1, 1, 1],  
                    padding='valid',
                    name="pool")

'''
h : éœ€è¦æ± åŒ–çš„è¾“å…¥ï¼Œä¸€èˆ¬æ± åŒ–å±‚æ¥åœ¨å·ç§¯å±‚åé¢ï¼Œ
è¾“å…¥é€šå¸¸æ˜¯feature mapï¼Œä¾ç„¶æ˜¯[batch_size, height, width, channels]è¿™æ ·çš„shape
k_size : æ± åŒ–çª—å£çš„å¤§å°ï¼Œå–ä¸€ä¸ªå››ç»´å‘é‡ï¼Œ
ä¸€èˆ¬æ˜¯[1, height, width, 1]ï¼Œå› ä¸ºä¸€èˆ¬ä¸æƒ³åœ¨batchå’Œchannelsä¸Šåšæ± åŒ–ï¼Œ
æ‰€ä»¥è¿™ä¸¤ä¸ªç»´åº¦è®¾ä¸ºäº†1
strides : çª—å£åœ¨æ¯ä¸€ä¸ªç»´åº¦ä¸Šæ»‘åŠ¨çš„æ­¥é•¿ï¼Œä¸€èˆ¬ä¹Ÿæ˜¯[1, stride,stride, 1]
'''

```

**Flatten**ï¼šç”¨äºå°†è¾“å…¥å±‚çš„æ•°æ®å‹æˆä¸€ç»´çš„æ•°æ®ï¼Œä¸€èˆ¬ç”¨äºå·ç§¯å±‚å’Œå…¨è¿æ¥å±‚ä¹‹é—´ï¼ˆå› ä¸ºå…¨è¿æ¥å±‚åªèƒ½æ¥æ”¶ä¸€ç»´æ•°æ®ï¼Œè€Œå·ç§¯å±‚å¯ä»¥å¤„ç†äºŒç»´æ•°æ®ï¼Œå°±æ˜¯å…¨è¿æ¥å±‚å¤„ç†çš„æ˜¯å‘é‡ï¼Œè€Œå·ç§¯å±‚å¤„ç†çš„æ˜¯çŸ©é˜µï¼‰ï¼Œä¸æ”¹å˜batchï¼Œå°†å…¶ä»–ç»´å‹ç¼©æˆä¸€ç»´ã€‚

```py

from tensorflow.keras.layers import Flatten
#Example:

model = Sequential()
model.add(Convolution2D(64, 3, 3,
                        border_mode='same',
                        input_shape=(3, 32, 32)))
# now: model.output_shape == (None, 64, 32, 32)

model.add(Flatten())
# now: model.output_shape == (None, 65536)
```

**Dense**ï¼šf.keras.layers.Denseç›¸å½“äºåœ¨å…¨è¿æ¥å±‚ä¸­æ·»åŠ ä¸€ä¸ªå±‚ã€‚Denseå®ç°æ“ä½œ output = activationï¼ˆdotï¼ˆinputï¼Œkernelï¼‰+ biasï¼‰ å…¶ä¸­ï¼Œactivationæ˜¯ç”¨activationå‚æ•°ä¼ é€’çš„é€å…ƒç´ æ¿€æ´»å‡½æ•°ï¼Œkernelæ˜¯è¯¥å±‚åˆ›å»ºçš„æƒé‡çŸ©é˜µï¼Œbiasæ˜¯ç”±å›¾å±‚åˆ›å»ºçš„åå·®å‘é‡ï¼ˆä»…åœ¨use_biasä¸ºTrueæ—¶é€‚ç”¨ï¼‰ã€‚

```py
tf.keras.layers.Dense(
    units,                                 # æ­£æ•´æ•°ï¼Œè¾“å‡ºç©ºé—´çš„ç»´æ•°
    activation=None,                       # æ¿€æ´»å‡½æ•°ï¼Œä¸æŒ‡å®šåˆ™æ²¡æœ‰
    use_bias=True,		           # å¸ƒå°”å€¼ï¼Œæ˜¯å¦ä½¿ç”¨åç§»å‘é‡
    kernel_initializer='glorot_uniform',   # æ ¸æƒé‡çŸ©é˜µçš„åˆå§‹å€¼è®¾å®šé¡¹
    bias_initializer='zeros',              # åå·®å‘é‡çš„åˆå§‹å€¼è®¾å®šé¡¹
    kernel_regularizer=None,               # æ­£åˆ™åŒ–å‡½æ•°åº”ç”¨äºæ ¸æƒçŸ©é˜µ
    bias_regularizer=None,                 # åº”ç”¨äºåå·®å‘é‡çš„æ­£åˆ™åŒ–å‡½æ•°
    ...
)

# å®ä¾‹
import tensorflow as tf

x = tf.random.normal([4, 784])

net = tf.keras.layers.Dense(512)
out = net(x)

out.shape
# TensorShape([4, 512])

net.kernel.shape, net.bias.shape
# (TensorShape([784, 512]), TensorShape([512]))

```

**optimizers.Adam()**ï¼šè¯¥å‡½æ•°è§£å†³ç›‘ç£å­¦ä¹ ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ—¶çš„å­¦ä¹ ç‡æ§åˆ¶é—®é¢˜ã€‚å¤§æ¦‚çš„æ€æƒ³æ˜¯å¼€å§‹çš„å­¦ä¹ ç‡è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒå¤§çš„å€¼ï¼Œç„¶åæ ¹æ®æ¬¡æ•°çš„å¢å¤šï¼ŒåŠ¨æ€çš„å‡å°å­¦ä¹ ç‡ï¼Œä»¥å®ç°æ•ˆç‡å’Œæ•ˆæœçš„å…¼å¾—ã€‚

```py
from tensorflow.keras import optimizers

keras.optimizers.Adam(lr=0.001, beta_1=0.9, beta_2=0.99, epsilon=1e-08, decay=0.0)

'''
lrï¼šfloat> = 0.å­¦ä¹ ç‡
beta_1ï¼šfloatï¼Œ0 <beta <1ã€‚ä¸€èˆ¬æ¥è¿‘1ã€‚ä¸€é˜¶çŸ©ä¼°è®¡çš„æŒ‡æ•°è¡°å‡ç‡
beta_2ï¼šfloatï¼Œ0 <beta <1ã€‚ä¸€èˆ¬æ¥è¿‘1ã€‚äºŒé˜¶çŸ©ä¼°è®¡çš„æŒ‡æ•°è¡°å‡ç‡
epsilonï¼šfloat> = 0,æ¨¡ç³Šå› å­ã€‚å¦‚æœNoneï¼Œé»˜è®¤ä¸ºK.epsilon()ã€‚
è¯¥å‚æ•°æ˜¯éå¸¸å°çš„æ•°ï¼Œå…¶ä¸ºäº†é˜²æ­¢åœ¨å®ç°ä¸­é™¤ä»¥é›¶
decayï¼šfloat> = 0,æ¯æ¬¡æ›´æ–°æ—¶å­¦ä¹ ç‡ä¸‹é™

'''

```

**sess.run(fetches,   feed_dict=None,    options=None,    run_metadata=None)**ï¼šå½“æ„å»ºå®Œå›¾åï¼Œéœ€è¦åœ¨ä¸€ä¸ªsessionä¼šè¯ä¸­å¯åŠ¨å›¾ï¼Œç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ã€‚ä¸ºäº†å–å›ï¼ˆFetchï¼‰æ“ä½œçš„è¾“å‡ºå†…å®¹, å¯ä»¥åœ¨ä½¿ç”¨ Session å¯¹è±¡çš„ run()è°ƒç”¨æ‰§è¡Œå›¾æ—¶ï¼Œä¼ å…¥ä¸€äº› tensor, è¿™äº› tensor ä¼šå–å›ç»“æœã€‚

## chap0 numpyåŸºæœ¬æ“ä½œ

è¿™é‡ŒæŒç»­ç½—åˆ—å­¦ä¹ åˆ°çš„ `numpy` ç›¸å…³æ“ä½œï¼š
1. æ„å»ºæ•°ç»„
```py
np.array                # æ„å»ºçŸ©é˜µ
np.asarray              # è½¬æ¢ä¸ºarrayå¯¹è±¡
np.zeros((x,y),dtype=)  # å…¨é›¶çŸ©é˜µ
np.ones((x,y),dtype=)   # å…¨ä¸€çŸ©é˜µ
np.eye((x),dtype=)      # å•ä½çŸ©é˜µ
np.random.randint(start,end,(x,y)) # éšæœºçŸ©é˜µ
np.linsapce(start,end,feet,dtype=).reshape([x,y])  # é¡ºåºçŸ©é˜µ

```
2. æ•°ç»„è¿ç®—
```py
np.add
np.subtract
np.miltiply
np.divide
np.dot
np.sqrt
np.sum
np.mean
np.exp
np.argmax
```
3. æ•°ç»„æ“ä½œ
```py
np.expand_dims(x,axis=) # å¢ç»´ï¼Œaxisæ§åˆ¶è½´çš„å‰å
np.concatenate(x,axis=) # æ‹¼æ¥ï¼Œaxisæ§åˆ¶æ‹¼æ¥çš„ç»´åº¦
```